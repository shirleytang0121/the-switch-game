{"ast":null,"code":"/**\r\n * @author       Richard Davey <rich@photonstorm.com>\r\n * @copyright    2019 Photon Storm Ltd.\r\n * @license      {@link https://github.com/photonstorm/phaser/blob/master/license.txt|MIT License}\r\n */\nvar Events = require('./events');\n/**\r\n * The Visibility Handler is responsible for listening out for document level visibility change events.\r\n * This includes `visibilitychange` if the browser supports it, and blur and focus events. It then uses\r\n * the provided Event Emitter and fires the related events.\r\n *\r\n * @function Phaser.Core.VisibilityHandler\r\n * @fires Phaser.Core.Events#BLUR\r\n * @fires Phaser.Core.Events#FOCUS\r\n * @fires Phaser.Core.Events#HIDDEN\r\n * @fires Phaser.Core.Events#VISIBLE\r\n * @since 3.0.0\r\n *\r\n * @param {Phaser.Game} game - The Game instance this Visibility Handler is working on.\r\n */\n\n\nvar VisibilityHandler = function VisibilityHandler(game) {\n  var hiddenVar;\n  var eventEmitter = game.events;\n\n  if (document.hidden !== undefined) {\n    hiddenVar = 'visibilitychange';\n  } else {\n    var vendors = ['webkit', 'moz', 'ms'];\n    vendors.forEach(function (prefix) {\n      if (document[prefix + 'Hidden'] !== undefined) {\n        document.hidden = function () {\n          return document[prefix + 'Hidden'];\n        };\n\n        hiddenVar = prefix + 'visibilitychange';\n      }\n    });\n  }\n\n  var onChange = function onChange(event) {\n    if (document.hidden || event.type === 'pause') {\n      eventEmitter.emit(Events.HIDDEN);\n    } else {\n      eventEmitter.emit(Events.VISIBLE);\n    }\n  };\n\n  if (hiddenVar) {\n    document.addEventListener(hiddenVar, onChange, false);\n  }\n\n  window.onblur = function () {\n    eventEmitter.emit(Events.BLUR);\n  };\n\n  window.onfocus = function () {\n    eventEmitter.emit(Events.FOCUS);\n  }; //  Automatically give the window focus unless config says otherwise\n\n\n  if (window.focus && game.config.autoFocus) {\n    window.focus();\n  }\n};\n\nmodule.exports = VisibilityHandler;","map":null,"metadata":{},"sourceType":"script"}